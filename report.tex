\documentclass[11pt,a4paper]{article}

\usepackage[pdftex]{graphicx}
\usepackage[cmex10]{amsmath}
\usepackage[usenames,dvipsnames]{color}
\usepackage{xspace}
\usepackage{fullpage}
\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\usepackage{textcomp}
\usepackage{multirow}
\usetikzlibrary{shapes,arrows}
\usetikzlibrary{pgfplots.groupplots}
\usepackage{url}
\usepackage{listings}
\usepackage{framed}

\newcommand{\todo}[1]{\textbf{\textcolor{Blue}{TODO: #1}}}
\newcommand{\hilight}[1]{\textit{\textcolor{Red}{#1}}}
\newcommand{\lst}[1]{\lstinline!#1!}
\newcommand{\fig}[1]{Fig.~\ref{#1}}
\newcommand{\eq}[1]{(\ref{#1})}
\newcommand{\ap}[1]{Appendix~\ref{#1}}
\newcommand{\tbl}[1]{Tbl.~\ref{#1}}
\newcommand{\file}[1]{\lstinline[basicstyle=\normalsize,]!#1!}
\newcommand{\pder}[2]{\frac{\partial{#1}}{\partial{#2}}}
\newcommand{\neuron}{CoreNeuron\xspace}
\newcommand{\dx}{{\Delta x}}
\newcommand{\dt}{{\Delta t}}
\newcommand{\at}[1]{{#1}_{i}}
\newcommand{\atplus}[1]{{#1}_{i+1}}
\newcommand{\atminus}[1]{{#1}_{i-1}}
\newcommand{\atplushalf}[1]{{#1}_{i+\frac{1}{2}}}
\newcommand{\atminushalf}[1]{{#1}_{i-\frac{1}{2}}}
\newcommand{\vv}[1]{\mathbf{#1}}
\newcommand{\att}[1]{{#1}^{n}}
\newcommand{\attplus}[1]{{#1}^{n+1}}
\newcommand{\attplushalf}[1]{{#1}^{n+\frac{1}{2}}}
\newcommand{\hoc}{\lst{.hoc}\xspace}

\lstdefinelanguage{julia}
{
    morekeywords = {
        if, elseif, else,
        for, while, end, in, using, local,
        type, function, return, yieldto, try, catch, error, throw, begin, quote,
        Int, Int32, Int64, Float, Float32, Float64, Array
    },
    sensitive = true,
    morecomment=[l]\#,
    morestring=[b]",
    morestring=[b]',
    moredelim=*[directive]@,
    moredirectives={assert, time, eval} % macros
}[keywords,comments,strings,directives]


\lstset{
    language=[ANSI]C++,
    %numbers=left,
    basicstyle=\small\ttfamily,
    identifierstyle=\color{Blue}\small\ttfamily,
    keywordstyle=\color{Red}\small\ttfamily\bf,
    commentstyle=\color{OliveGreen}\small\ttfamily,
    breaklines=true
}
\lstset{
    emph={pw_stop_collector,
          pw_start_collector,
          pw_new_collector,
          pw_print_table
    },
    emphstyle={\color{Bittersweet}\bfseries\normalsize}
}

\definecolor{shadecolor}{rgb}{0.8,0.8,0.8}

\begin{document}

% title and cover page
\title{\neuron Overview}
\author{Ben Cumming\\CSCS -- Swiss National Supercomputing Center}
\date{\today}
\maketitle

% abstract
\abstract{
This document presents an overview of the \neuron code that was released as part of the PCP process for the Human Brain Project in July 2014. The analysis focuses on the structure of the code that has the highest computational overheads.

More detailed analysis of the algorithms themselves, and important parts of the code like spike communication, that do not contribute meaniningfully to the time to solution are not considered for analysis. For now I will focus on just the computationally intensive parts of the code.

Note that this analysis is based on an early version of the \neuron code, and that different algorithms (e.g. modelling plasticity) may significantly increase the importance of parts of the application not yet considered here.
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{What is \neuron?}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The version of \neuron that was released for the PCP is derived directly from \emph{Bluron}, a flavour of \emph{Neuron} maintained by the Blue Brain Project (BBP) group at EPFL. \neuron is derived directly in the sense that it is a subset of the features and corresponding code from \emph{Bluron}. The code has been modified as much as needed to remove it from the larger \emph{Bluron} infrastructure, and reduce the memory footprint of the code.

Note that \emph{Bluron} refers to the \emph{Neuron} plus the \hoc files used to define the models used in the BBP group. The computational back end is identical for both \emph{Bluron} and \emph{Neuron}. \hilight{Correct me if this is wrong.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The Code}
\input{overview.tex}

\section{Code Walkthrough}
\input{high_level.tex}

\subsection{The Algorithm}
\input{maths.tex}

\subsection{Implementation of a time step}
\input{timestep_impl.tex}

\section{Benchmarking}
\input{benchmarking.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%   appendices
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\clearpage
%\appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
%\section{Source code for constructing a tree}
%\input{appendix_tree.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newpage
%\section{Source code for Hines algorithm}
%\label{appendix:hinessource}
%\input{appendix_hines.tex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}
